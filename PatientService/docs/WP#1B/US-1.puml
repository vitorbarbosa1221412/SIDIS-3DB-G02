@startuml
title WP1B-6: As an Administrator I want to update a physician's data

autonumber
autoactivate on

actor "Administrator" as admin
participant "PhysicianAPI" as api
participant "PhysicianService" as service
participant "Mapper: PhysicianEditMapper" as editMapper
participant "ViewMapper: PhysicianViewMapper" as viewMapper
participant "repo: PhysicianRepository" as repo
participant "obj: Physician" as physician
participant "Security: AuthContext" as auth


admin -> api : PUT /physician/{physicianNumber}\nBody: PhysicianEditDTO
api -> auth : getAuthenticatedUser()
auth --> api : AdminUserDetails

api -> service : update(physicianNumber, dto, authenticatedUser)


service -> repo : findByPhysicianNumber(physicianNumber)
repo --> service : Optional<Physician>
service -> service : validateAdminAccess(authenticatedUser)


service -> editMapper : updateEntity(physician, dto)
editMapper --> service : updatedPhysician


service -> repo : save(updatedPhysician)
repo --> service : savedPhysician


service -> viewMapper : toDTO(savedPhysician)
viewMapper --> service : PhysicianViewDTO
service --> api : PhysicianViewDTO
api --> admin : HTTP 200 OK + body(PhysicianViewDTO)

@enduml
